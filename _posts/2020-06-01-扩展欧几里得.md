---
layout: blog
title: 扩展欧几里得
id: 000006
category: blog
description:
published: true
---

扩展欧几里得就是欧几里得的扩展，先说说欧几里得算法吧
```python
def gcd(a,b):
    if b == 0:
        return a
    else:
        return gcd(b,a%b)
```
这段代码想必大家在熟悉不过了吧，，但是有没有想过为什么gcd(a,b)=gcd(b,a%b)？
定义一下符号：
$$
(x,y)=gcd(x,y)\\
a=:bq+r\\
g:=(a,b)\\
k:=(b,r)\\
$$
证明：
$$
(bq+r,b)=g\Rightarrow g|(bq+r)\\
\because g|b \Rightarrow g|bq\\
\therefore g|bq+r-bq \Rightarrow g|r \Rightarrow g|(b,r) \Rightarrow g|k\\
(b,r)=k\Rightarrow k|r\\
\because k|b\Rightarrow k|bq\\
\therefore k|bq+r\Rightarrow k|(bq+r,b)\Rightarrow k|g\\
\because g|k,k|g\\
\therefore g=k
$$

***
那么扩展欧几里得是啥呢？
首先来一个方程吧
ax+by=gcd(a,b)
哈哈哈，这个方程不知道童鞋们都听过多少次了"\*★,°\*:.☆(￣▽￣)/$:\*.°★\* 。"
其中abxy都是整数！！！
（满满的小学奥数的感觉呐）
就是所谓的，**不定方程**
为啥要拿欧几里得算法写呢，因为……
因为我也不知道啊！！(●ˇ∀ˇ●)
```python
def exgcd(a, b):     
    if b == 0:         
        return 1, 0, a     
    else:         
        x, y, q = exgcd(b, a % b)        
        x, y = y, (x - (a // b) * y)         
        return x, y, q
```
精华在于x, y = y, (x - (a // b) \* y)，
why?
$$
bx+(a\space mod\space b)y=a\times?+b\times?
$$
我们要首先透彻的知道a%b到底内部是什么样子的：
$$
 a\space mod \space b = a-(\lfloor a/b\rfloor \times b)
$$
 代入
$$
 bx+(a-(\lfloor a/b\rfloor \times b))y=a\times?+b\times?
$$
 展开
$$
 bx+ay-\lfloor a/b\rfloor \times b\times y=a\times?+b\times?
$$
 把a和b提取结果显然
$$
ay+b(x-\lfloor a/b\rfloor \times y)=a\times?+b\times?
$$
 你会发现，这个就是上面的那段精华。

***
